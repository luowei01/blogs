<!-- toc -->

# 最小二乘法

## 1. 定义
记拟合函数$\psi(x)$在$x_i$处的偏差/残差$\epsilon_i=\psi(x_i)-f(x_i) \quad (i=1,2,...,n)$向量$e=[\epsilon_1,\epsilon_2,..., \epsilon_n]^T$,求$e$的某种范数$\|e\|$最小。为了便于计算，常取2-范数，这种要求误差（偏差）平方和最小的拟合称为曲线拟合的最小二乘法。

$
\|e\|_2=\left(\sum\limits_{i=0}^n \epsilon_i^2\right)^{1/2}=\left\{\sum\limits_{i=0}^n [\psi(x_i)-f(x_i)]^2\right\}^{1/2}\\
\|e\|^2_2=\sum\limits_{i=0}^n \epsilon_i^2=\sum\limits_{i=0}^n [\psi(x_i)-f(x_i)]^2
$

## 2.多项式拟合

多项式拟合问题：给定一组数据$(x_i,y_i),(i=1,2,...,m)$，拟合出次数不超过$n(n<<m)$ 的多项式：

$
y = a_0 + a_1 x + a_2 x^2 + ... + a_n x^n=\sum\limits_{j=0}^n a_j x^j
$

偏差：

$
Q = \sum\limits_{i=1}^m \left(y_i - (a_0 + a_1 x_i + a_2 x_i^2 + ... + a_n x_i^n)\right)^2=\sum\limits_{i=1}^m \left(y_i - \sum\limits_{j=0}^n a_j x_i^j\right)^2
$

当偏差最小时，极值点导数为0：

$
\frac{\partial Q}{\partial a_k} =\sum\limits_{i=1}^m \left(y_i - \sum\limits_{j=0}^n a_j x_i^j\right)x_i^k= 0 \quad k=0,1,...,n
$

由此可得关于系数$a_k$的线性方程组即正规方程组：

$
a_0m+a_1\sum x_i+\dots+a_n\sum{x_i^n}= \sum y_i \\
a_0\sum x_i+a_1\sum x_i^2+\dots+a_n\sum  x_i^{n+1}= \sum x_i y_i\\
\dots\\
a_0\sum x_i^n+a_1\sum x_i^{n+1}+\dots+a_n\sum x_i^{2n}= \sum x_i^{2n} y_i
$


