
<!DOCTYPE HTML>
<style>
    .navbar {
        display: flex;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        width: 100%;
        z-index: 1000;
        /* 确保导航栏位于其他内容上方 */
        justify-content: space-around;
        align-items: center;
        padding: 5px;
        background-color: #f0f0f0;
        font-size: 18px;
        /* 放大字号 */
    }

    .navbar a {
        text-decoration: none;
        color: #333;
    }

    .current {
        font-weight: bold;
        color: #ff0000;
        /* 高亮颜色 */
    }
</style>

<div class="navbar">
    <a href="https://www.chateda.top/">首页</a>
    <a href="https://www.chateda.top/about/" >关于</a>
    <a href="https://www.chateda.top/archive/">归档</a>
    <a href="https://www.chateda.top/tags/">标签</a>
    <a href="https://blog.chateda.top/" class="current">全部博客</a>
</div>
<style>
    /* 空白占位元素 */
    .navbar-placeholder {
        height: 40px;
        /* 与导航栏高度相同 */
    }
</style>
<div class="navbar-placeholder"></div>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>5.数据并行处理 · 听风雨的博客</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="luowei">
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-alerts/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-gtalk/gtalk.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-atoc/atoc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-insert-logo/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-change_girls/girls.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-auto-scroll-table/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    


    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="实验一：手写数字识别.html" />
    
    
    <link rel="prev" href="4.torch数据集类、加载、自带数据集、transform处理图像数据.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    README
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="./">
            
                <a href="./">
            
                    
                    深度学习
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="0.Configure_deep_learning_environment.html">
            
                <a href="0.Configure_deep_learning_environment.html">
            
                    
                    0.环境配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="1.torch.tensor的初始化和基本操作.html">
            
                <a href="1.torch.tensor的初始化和基本操作.html">
            
                    
                    1.torch.tensor的初始化和基本操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="2.pytorch自动微分-autograd.html">
            
                <a href="2.pytorch自动微分-autograd.html">
            
                    
                    2.pytorch自动微分-autograd
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="2.梯度求导和反向传播（require_grad = True和False时tensor的区别）.html">
            
                <a href="2.梯度求导和反向传播（require_grad = True和False时tensor的区别）.html">
            
                    
                    2.pytorch神经网络模块-nn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="2.实验：手动实现线性回归.html">
            
                <a href="2.实验：手动实现线性回归.html">
            
                    
                    2.实验：手动实现线性回归
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="3.pytorch.nn神经网络的简易构建.html">
            
                <a href="3.pytorch.nn神经网络的简易构建.html">
            
                    
                    3.pytorch.nn神经网络的简易构建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="4.torch数据集类、加载、自带数据集、transform处理图像数据.html">
            
                <a href="4.torch数据集类、加载、自带数据集、transform处理图像数据.html">
            
                    
                    4.torch数据集类、加载、自带数据集、transform处理图像数据
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.8" data-path="5.数据并行处理.html">
            
                <a href="5.数据并行处理.html">
            
                    
                    5.数据并行处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="实验一：手写数字识别.html">
            
                <a href="实验一：手写数字识别.html">
            
                    
                    实验一：手写数字识别
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="实验二：文本情感分类.html">
            
                <a href="实验二：文本情感分类.html">
            
                    
                    实验二：文本情感分类
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../比赛相关/">
            
                <a href="../比赛相关/">
            
                    
                    比赛相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../比赛相关/第五届EDA精英挑战赛赛题八-标准单元电路的版图自动生成.html">
            
                <a href="../比赛相关/第五届EDA精英挑战赛赛题八-标准单元电路的版图自动生成.html">
            
                    
                    标准单元电路的版图自动生成（第五届EDA精英挑战赛赛题八)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../数值分析/">
            
                <a href="../数值分析/">
            
                    
                    数值分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../数值分析/引论.html">
            
                <a href="../数值分析/引论.html">
            
                    
                    引论
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../数值分析/插值法.html">
            
                <a href="../数值分析/插值法.html">
            
                    
                    插值法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../数值分析/最小二乘.html">
            
                <a href="../数值分析/最小二乘.html">
            
                    
                    最小二乘
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../数值分析/逼近论.html">
            
                <a href="../数值分析/逼近论.html">
            
                    
                    逼近论
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../数值分析/note.html">
            
                <a href="../数值分析/note.html">
            
                    
                    手写笔记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../量子EDA/">
            
                <a href="../量子EDA/">
            
                    
                    量子EDA
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../量子EDA/Introducing Design Automation for Quantum Computing.html">
            
                <a href="../量子EDA/Introducing Design Automation for Quantum Computing.html">
            
                    
                    量子计算设计自动化综述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../量子EDA/Quantum Fourier Transform.html">
            
                <a href="../量子EDA/Quantum Fourier Transform.html">
            
                    
                    量子傅里叶变换
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >5.数据并行处理</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <p>&#x901A;&#x8FC7;.to(device) &#x5C06;&#x6A21;&#x578B;&#x548C;&#x5F20;&#x91CF;&#x653E;&#x5230;GPU&#x8FD0;&#x884C;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x591A;GPU&#xFF0C;&#x9700;&#x8981;&#x5148;&#x7528;nn.DataParallel(model)&#x5305;&#x88F9;&#x6A21;&#x578B;&#xFF0C;&#x6A21;&#x578B;&#x4F1A;&#x6839;&#x636E;GPU&#x6570;&#x91CF;&#x5C06;&#x4E00;&#x6279;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x4EFB;&#x52A1;&#x5206;&#x914D;&#xFF0C;&#x6279;&#x91CF;&#x8FD0;&#x884C;&#x3002;</p>
<h1 id="&#x5C06;&#x6A21;&#x578B;&#x653E;&#x5728;&#x4E00;&#x4E2A;gpu&#x4E0A;">&#x5C06;&#x6A21;&#x578B;&#x653E;&#x5728;&#x4E00;&#x4E2A;Gpu&#x4E0A;</h1>
<p>device = torch.device(&quot;cuda:0&quot; if torch.cuda.is_available() else &quot;cpu&quot;)#&#x6307;&#x5B9A;&#x4F7F;&#x7528;&#x7684;gpu
model.to(device)</p>
<h1 id="&#x590D;&#x5236;&#x5F20;&#x91CF;&#x5230;gpu">&#x590D;&#x5236;&#x5F20;&#x91CF;&#x5230;GPU</h1>
<p>mytensor = my_tensor.to(device) #&#x590D;&#x5236;&#x4E00;&#x4E2A;&#x65B0;&#x7684;my_tensor&#x5728;GPU&#x4E0A;
model = nn.DataParallel(model)#&#x8BA9;&#x6A21;&#x578B;&#x5E76;&#x884C;&#x8FD0;&#x884C;&#x5728;&#x591A;GPU&#x4E0A;</p>
<pre class="language-"><code class="lang-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
</code></pre>
<pre class="language-"><code class="lang-python">torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>device_count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#&#x67E5;&#x770B;gpu&#x6570;&#x91CF;</span>
</code></pre>
<pre class="language-"><code>1
</code></pre><pre class="language-"><code class="lang-python"><span class="token keyword">from</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data <span class="token keyword">import</span> Dataset<span class="token punctuation">,</span>DataLoader <span class="token comment">#&#x6570;&#x636E;&#x96C6;&#x3001;&#x6570;&#x636E;&#x52A0;&#x8F7D;&#x7684;&#x7236;&#x7C7B;&#x65B9;&#x6CD5;</span>
<span class="token comment">#&#x53C2;&#x6570;</span>
input_size <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment">#&#x6570;&#x636E;&#x7684;&#x5F62;&#x72B6;</span>
batch_size <span class="token operator">=</span> <span class="token number">30</span> <span class="token comment">#&#x4E00;&#x6279;&#x6570;&#x636E;&#x7684;&#x6570;&#x91CF;</span>
data_size <span class="token operator">=</span> <span class="token number">100</span> <span class="token comment">#&#x6570;&#x636E;&#x7684;&#x603B;&#x6570;&#x91CF;&#xFF1A;&#x5206;&#x6210;&#x4E09;&#x6279;30+10</span>
output_size <span class="token operator">=</span> <span class="token number">2</span>
</code></pre>
<pre class="language-"><code class="lang-python"><span class="token comment"># &#x5B9E;&#x9A8C;&#x6570;&#x636E;&#x751F;&#x6210;&#xFF0C;&#x5305;&#x88C5;&#x6210;Dataloader</span>
<span class="token keyword">class</span> <span class="token class-name">RandomDataset</span><span class="token punctuation">(</span>Dataset<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>input_size<span class="token punctuation">,</span>data_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span><span class="token builtin">len</span> <span class="token operator">=</span> data_size
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>data_size<span class="token punctuation">,</span>input_size<span class="token punctuation">)</span> <span class="token comment">#&#x751F;&#x6210;100*5&#x7684;&#x6570;&#x636E;</span>
    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">len</span>
</code></pre>
<pre class="language-"><code class="lang-python"><span class="token comment">#&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x6A21;&#x578B;</span>
<span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>input_size<span class="token punctuation">,</span>output_size<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Model<span class="token punctuation">,</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>input_size<span class="token punctuation">,</span>output_size<span class="token punctuation">)</span> <span class="token comment">#&#x4E00;&#x4E2A;&#x7EBF;&#x6027;&#x5C42;&#xFF0C;&#x8F93;&#x5165;&#x5F62;&#x72B6;&#x4E3A;5&#xFF0C;&#x8F93;&#x51FA;&#x5F62;&#x72B6;&#x4E3A;2</span>
    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        output <span class="token operator">=</span> self<span class="token punctuation">.</span>fc<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span><span class="token comment">#&#x8F93;&#x5165;&#x7EBF;&#x6027;&#x6620;&#x5C04;&#x5230;&#x8F93;&#x51FA;</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\tIn Model: input_size&quot;</span><span class="token punctuation">,</span><span class="token builtin">input</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;Output size&quot;</span><span class="token punctuation">,</span>output<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> output
</code></pre>
<pre class="language-"><code class="lang-python">device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">&quot;cuda:0&quot;</span><span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">&quot;cpu&quot;</span><span class="token punctuation">)</span> <span class="token comment">#&#x6307;&#x5B9A;&#x8BBE;&#x5907;</span>
<span class="token comment">#&#x751F;&#x6210;100&#x4E2A;&#x957F;&#x5EA6;&#x4E3A;5&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5E76;&#x6253;&#x4E71;&#x987A;&#x5E8F;&#xFF0C;&#x6BCF;30&#x4E2A;&#x4E3A;&#x4E00;&#x6279;</span>
rand_loader <span class="token operator">=</span> DataLoader<span class="token punctuation">(</span>dataset<span class="token operator">=</span> RandomDataset<span class="token punctuation">(</span>input_size<span class="token punctuation">,</span>data_size<span class="token punctuation">)</span><span class="token punctuation">,</span>batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> 
model <span class="token operator">=</span> Model<span class="token punctuation">(</span>input_size<span class="token punctuation">,</span>output_size<span class="token punctuation">)</span><span class="token comment">#&#x521B;&#x5EFA;&#x6A21;&#x578B;</span>
model <span class="token operator">=</span> nn<span class="token punctuation">.</span>DataParallel<span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token comment"># &#x5F53;&#x6709;&#x591A;&#x4E2A;GPU&#x65F6;&#xFF0C;&#x901A;&#x8FC7;DataParallel&#x5305;&#x88F9;&#x6A21;&#x578B;&#xFF0C;&#x653E;&#x5230;&#x591A;GPU&#x4E0A;&#x5E76;&#x884C;&#x8FD0;&#x884C;</span>
model<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span> <span class="token comment">#&#x5C06;&#x6A21;&#x578B;&#x653E;&#x5230;&#x591A;GPU&#x91CC;</span>
<span class="token comment">#100&#x4E2A;&#x6570;&#x636E;&#x5206;&#x56DB;&#x6B21;&#x5728;&#x591A;GPU&#x4E0A;&#x8DD1;&#x5B8C;&#xFF1A;30&#x3001;30&#x3001;30&#x3001;10&#xFF0C;&#x6BCF;&#x4E00;&#x6279;&#x6570;&#x636E;&#x5C06;&#x4F1A;&#x6839;&#x636E;GPU&#x7684;&#x6570;&#x91CF;&#x5E73;&#x5747;&#x5206;&#x914D;&#x4EFB;&#x52A1;</span>
<span class="token comment">#&#x8FD9;&#x91CC;&#x53EA;&#x6709;&#x4E00;&#x4E2A;GPU&#xFF0C;&#x6240;&#x4EE5;&#x8DD1;&#x7B2C;&#x4E00;&#x6279;&#x6570;&#x636E;&#x65F6;&#x6A21;&#x578B;&#x4F1A;&#x671F;&#x671B;&#x83B7;&#x5F97;30&#x4E2A;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#xFF0C;&#x82E5;&#x4E24;&#x4E2A;GPU&#x5219;&#x4E3A;&#x6BCF;&#x4E2A;GPU15&#x4E2A;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;</span>
<span class="token keyword">for</span> data <span class="token keyword">in</span> rand_loader<span class="token punctuation">:</span> 
    <span class="token builtin">input</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span> <span class="token comment">#&#x5C06;&#x4E00;&#x6279;&#x6570;&#x636E;30*5&#x590D;&#x5236;&#x540E;&#x653E;&#x5230;GPU&#x4E0A;</span>
    output <span class="token operator">=</span> model<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
</code></pre>
<pre class="language-"><code>    In Model: input_size torch.Size([30, 5]) Output size torch.Size([30, 2])
tensor([[ 1.3998,  1.2502, -1.1896,  0.4304, -0.4955],
        [ 0.6864,  1.9052,  1.1797,  0.4090,  0.8642],
        [ 0.7506, -1.0246, -1.6477, -0.5171, -0.0144],
        [ 1.3106, -1.5225, -0.9430,  0.3141,  1.9123],
        [ 1.0573, -0.2924,  0.8618,  0.4295, -0.7217],
        [ 0.3638,  0.0907,  1.6479,  0.1283, -1.3053],
        [ 1.2924, -0.3428,  0.6310,  0.4793,  0.6701],
        [ 1.8357,  0.7652, -1.8002, -0.1317,  1.6598],
        [-0.6599,  0.7767,  1.0053,  0.1474,  0.5814],
        [ 0.8478,  0.6015,  0.5130, -0.0224,  0.8288],
        [-0.2636, -0.3118, -0.2701, -0.9767, -0.2967],
        [ 0.7115,  1.7632,  0.1660, -0.6052, -0.5283],
        [-0.6665,  1.2859, -0.3946, -0.4079, -0.3478],
        [ 0.0567,  0.4262,  1.2631, -0.4811, -0.9828],
        [ 0.4011, -0.0245, -0.4672, -1.5755, -0.5582],
        [ 0.4740, -1.6728, -0.2675,  0.9257, -0.1911],
        [ 0.2513,  0.8764, -1.0027,  0.0539, -0.6720],
        [-1.7727,  0.8830,  0.3481, -0.1401, -1.1334],
        [ 1.7107,  0.0463,  0.7738,  0.9380, -1.3504],
        [ 0.5126, -0.3576, -1.2318,  1.0766,  0.9749],
        [-1.0016, -1.6359,  0.0756,  0.1361,  0.7690],
        [-0.4070, -0.9672,  0.0666, -1.5400, -0.2621],
        [ 2.0251,  0.0809, -0.1042, -0.0352,  2.4577],
        [ 0.4857, -0.4238,  0.2555, -0.3199,  1.7891],
        [-0.8048, -0.1197, -0.2343, -0.4379, -0.2754],
        [-1.1243, -0.8615, -0.4208, -0.8382, -3.2918],
        [-1.3045,  0.3495,  1.7364, -0.8862,  0.1597],
        [ 1.0946,  1.1148, -0.1790, -1.4312,  1.0513],
        [-2.2245,  1.3228, -0.7857, -0.5271, -0.7456],
        [ 0.6569,  1.6206, -2.2606,  1.5304,  0.1448]], device=&apos;cuda:0&apos;)
tensor([[ 1.3354, -0.4408],
        [ 1.5101,  0.1422],
        [ 0.2464, -0.6226],
        [ 0.5474, -0.4104],
        [ 0.5074, -0.4467],
        [ 0.3219, -0.3651],
        [ 0.7759, -0.2624],
        [ 1.5503, -0.1377],
        [ 0.6384, -0.1048],
        [ 1.0098, -0.0566],
        [ 0.1108, -0.3593],
        [ 1.1840, -0.0599],
        [ 0.6992, -0.2681],
        [ 0.3742, -0.2307],
        [ 0.3070, -0.2558],
        [-0.0172, -0.8141],
        [ 0.8059, -0.4891],
        [ 0.1222, -0.4482],
        [ 0.7791, -0.5618],
        [ 0.7514, -0.5913],
        [-0.3483, -0.5526],
        [-0.2580, -0.3179],
        [ 1.3869,  0.1021],
        [ 0.6292, -0.0529],
        [ 0.1026, -0.4376],
        [-0.7701, -0.9900],
        [ 0.0914,  0.0023],
        [ 1.1931,  0.2047],
        [ 0.2431, -0.4285],
        [ 1.5453, -0.6408]], device=&apos;cuda:0&apos;, grad_fn=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AddmmBackward0</span><span class="token punctuation">&gt;</span></span>)
    In Model: input_size torch.Size([30, 5]) Output size torch.Size([30, 2])
tensor([[-9.5780e-01, -7.5886e-01,  1.9236e-02, -4.8388e-01,  1.0122e+00],
        [ 1.6689e-01, -1.1247e+00,  2.2246e-01,  1.6482e+00, -6.9651e-01],
        [-1.0487e+00, -1.6386e-01, -2.1590e+00,  2.3110e-01, -1.8020e-01],
        [ 3.1493e-04,  7.0393e-01,  2.0773e-01,  9.8784e-01,  1.0538e+00],
        [-6.3951e-01,  6.3711e-01,  1.4174e+00, -1.2572e+00, -1.7681e-01],
        [-2.1382e+00,  4.3187e-01,  1.1226e+00,  1.8231e+00, -1.7205e+00],
        [-8.4624e-01,  1.4595e+00,  1.0381e+00, -6.9887e-01, -2.4990e+00],
        [-1.6691e+00, -9.8542e-01,  4.3054e-01,  1.6838e-01, -1.5251e-01],
        [-1.8630e-01,  6.1140e-01, -7.0218e-01,  1.2116e-01, -4.1111e-01],
        [-5.8279e-01,  1.0899e+00, -1.0506e+00,  2.7525e-01,  2.3481e-01],
        [ 1.8877e-01,  3.5218e-02, -6.2246e-01, -1.1856e+00,  2.9768e-01],
        [ 7.6280e-01,  1.7437e+00, -1.6927e-01,  2.0591e+00, -1.9448e-01],
        [ 8.4804e-01,  1.8089e+00,  1.4965e+00,  1.4096e+00,  6.3428e-01],
        [-7.2712e-01,  5.4424e-01,  4.9631e-01, -1.5711e+00,  7.6291e-02],
        [ 1.6211e-01, -3.4816e-01, -5.0712e-01,  5.1419e-01,  3.6964e-02],
        [-1.1377e+00, -2.0432e-01,  8.8319e-01, -8.7732e-02, -3.8484e-01],
        [-2.5830e+00,  7.7596e-01,  1.3320e-01,  1.2762e-01, -1.6620e-01],
        [-1.2100e+00,  2.6715e-01,  1.2773e-01, -1.5132e+00,  1.7489e-01],
        [ 1.5924e+00, -5.8187e-01,  2.4304e-02, -4.7442e-01, -8.8907e-01],
        [ 1.4525e+00,  1.7149e+00, -1.2975e+00,  1.2307e+00, -8.4815e-01],
        [-4.3457e-01, -1.1473e+00,  3.2537e-01, -1.5696e+00,  1.1417e-02],
        [-3.5440e-01,  8.9465e-01, -1.8591e-01, -5.5836e-01,  8.2611e-01],
        [-8.4165e-01, -9.4987e-01, -8.5853e-01, -3.6496e-01, -9.8048e-01],
        [-1.1483e+00, -1.1356e-01,  4.1353e-02, -1.3213e+00, -1.8714e-01],
        [-6.9137e-01, -1.1348e-01,  4.2108e-02,  1.9132e+00,  1.8538e+00],
        [ 7.6306e-01,  1.2829e+00,  1.1593e+00, -7.1834e-01,  6.2651e-01],
        [-3.4217e-01, -6.3654e-01,  4.7631e-01, -1.0224e+00, -1.7735e+00],
        [-1.5070e+00, -1.9161e-01,  1.0612e+00,  3.4664e-01,  1.3255e+00],
        [ 5.3883e-01,  1.9607e+00,  1.4431e+00,  1.0221e+00,  3.6899e+00],
        [ 4.4198e-01,  4.5949e-01,  3.6734e-02, -7.2834e-01,  3.8322e-01]],
       device=&apos;cuda:0&apos;)
tensor([[-0.0137, -0.2931],
        [ 0.0995, -0.8851],
        [ 0.1875, -0.7985],
        [ 0.9801, -0.2512],
        [ 0.3060,  0.0410],
        [-0.0674, -0.8438],
        [ 0.3029, -0.3569],
        [-0.4176, -0.5952],
        [ 0.6177, -0.4783],
        [ 0.8322, -0.3975],
        [ 0.4522, -0.2068],
        [ 1.5388, -0.4885],
        [ 1.5732, -0.0235],
        [ 0.2896, -0.0039],
        [ 0.4291, -0.5676],
        [-0.0463, -0.3954],
        [ 0.0482, -0.4208],
        [ 0.0873, -0.1074],
        [ 0.4480, -0.4491],
        [ 1.5713, -0.5729],
        [-0.3099, -0.2636],
        [ 0.7791, -0.0733],
        [-0.3110, -0.7607],
        [-0.0789, -0.2582],
        [ 0.6969, -0.4472],
        [ 1.1268,  0.2023],
        [-0.3000, -0.5372],
        [ 0.1584, -0.1904],
        [ 1.9754,  0.5204],
        [ 0.7226, -0.1112]], device=&apos;cuda:0&apos;, grad_fn=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AddmmBackward0</span><span class="token punctuation">&gt;</span></span>)
    In Model: input_size torch.Size([30, 5]) Output size torch.Size([30, 2])
tensor([[ 0.3781,  2.1261, -0.3597,  0.3549, -2.1107],
        [-0.0709, -1.4302,  1.4230,  0.8944, -1.1881],
        [-0.9975,  0.3456, -0.2782,  0.2082, -0.2557],
        [-1.8932,  0.4349,  0.8883, -1.1904, -1.5182],
        [ 0.3455,  0.5789, -2.3086, -0.8742,  1.1737],
        [ 0.0169, -0.5500, -0.7310, -0.0464,  1.1175],
        [-0.1645, -0.5905,  0.9990, -0.6432,  0.7527],
        [ 0.5220, -0.4567,  1.1042, -0.8809,  0.5406],
        [-0.1422, -0.5740,  0.3312, -0.7692,  1.6345],
        [ 0.1451,  0.0947,  0.8352, -0.7859,  1.8668],
        [ 1.9446, -1.3905,  0.2506,  0.9803,  0.2194],
        [ 0.0615,  1.3827, -0.0128, -0.4939, -0.2779],
        [-1.1412,  1.1279, -2.0840,  1.1058,  0.2850],
        [ 1.2718, -0.8321, -0.4539, -0.1579,  0.9745],
        [ 1.1226,  1.0046,  0.8519, -0.8238,  0.1195],
        [-0.7281,  0.0879, -1.3753,  1.2879,  0.4902],
        [ 0.5696,  0.2200, -0.3299,  0.1004,  0.1422],
        [-1.5161, -0.8023, -1.0319, -0.2165,  0.7449],
        [-1.5832, -1.6690, -0.9242,  0.9560, -1.0835],
        [ 0.7799,  1.5120, -0.8574,  0.8296,  0.4161],
        [-0.6846,  0.8758, -0.1340,  0.2472,  0.0223],
        [-0.4372, -1.2618, -0.1331,  1.4128,  0.4364],
        [-0.7120, -0.3535, -1.2841, -0.2905, -0.2255],
        [ 1.2310,  0.9690,  0.3350,  0.6503,  0.8104],
        [ 1.2663,  0.5659,  0.3049, -0.4675,  0.6860],
        [ 0.9824, -0.4866,  1.1276,  0.3263, -0.4636],
        [-1.2399, -1.2226,  0.5335, -0.2183, -1.0702],
        [-0.1033,  2.6522, -0.6016,  1.9526,  0.5291],
        [ 1.4843,  1.3897,  0.2812, -0.2434, -1.1302],
        [ 0.3419, -0.3271, -1.0362,  0.0159,  0.6600]], device=&apos;cuda:0&apos;)
tensor([[ 1.1250, -0.4977],
        [-0.2915, -0.7381],
        [ 0.3107, -0.4889],
        [-0.2819, -0.3359],
        [ 0.9483, -0.2534],
        [ 0.4234, -0.3703],
        [ 0.1667, -0.1205],
        [ 0.3407, -0.0503],
        [ 0.3276, -0.0441],
        [ 0.6829,  0.1686],
        [ 0.5326, -0.5833],
        [ 0.9167, -0.1462],
        [ 0.8389, -0.6798],
        [ 0.5993, -0.3206],
        [ 1.0364,  0.0774],
        [ 0.5543, -0.7148],
        [ 0.7285, -0.3606],
        [-0.1469, -0.5467],
        [-0.6670, -1.1388],
        [ 1.4415, -0.3118],
        [ 0.6457, -0.3431],
        [ 0.0457, -0.7619],
        [ 0.1018, -0.6184],
        [ 1.3349, -0.1229],
        [ 1.0467, -0.0185],
        [ 0.4269, -0.3861],
        [-0.5827, -0.6764],
        [ 1.7875, -0.3241],
        [ 1.1831, -0.2163],
        [ 0.5490, -0.4450]], device=&apos;cuda:0&apos;, grad_fn=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AddmmBackward0</span><span class="token punctuation">&gt;</span></span>)
    In Model: input_size torch.Size([10, 5]) Output size torch.Size([10, 2])
tensor([[ 0.9590,  0.2783,  0.0272,  0.3649, -0.2138],
        [-1.0221,  1.1539, -0.0216, -1.3887, -1.1672],
        [-0.8936,  0.5761, -0.0550,  0.1512,  0.1143],
        [-1.2700, -1.3692, -1.1519,  0.2763, -0.7863],
        [-1.0240,  0.0134, -1.4516,  1.6743,  1.0821],
        [ 0.0467, -0.4071,  1.1326,  0.3910, -0.5588],
        [-0.6852,  0.4864, -0.4666,  1.8307, -2.5082],
        [ 0.0563, -0.5627,  0.4909,  0.7415,  1.0557],
        [-0.1177,  0.9946, -0.6947,  1.1342,  1.8939],
        [-0.3377,  1.6454,  0.2866, -0.5777,  0.7929]], device=&apos;cuda:0&apos;)
tensor([[ 0.8144, -0.3875],
        [ 0.3073, -0.2230],
        [ 0.4709, -0.3550],
        [-0.4820, -0.9528],
        [ 0.5800, -0.7194],
        [ 0.2019, -0.4431],
        [ 0.2897, -1.0988],
        [ 0.4517, -0.3516],
        [ 1.2458, -0.2239],
        [ 1.0559,  0.0932]], device=&apos;cuda:0&apos;, grad_fn=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AddmmBackward0</span><span class="token punctuation">&gt;</span></span>)
</code></pre><p><div id="gitalk-container"></div><script src="//cdn.staticfile.org/gitalk/1.8.0/gitalk.min.js"></script><script>window.onload = function() {gitbook.events.on("page.change", function() {var gitalk = new Gitalk({"clientID":"Ov23liXJ47TD4diLy6Z5","clientSecret":"00f665c53d4f4f4ef1a0c8b86a918636233b54c5","repo":"blogs","owner":"luowei01","admin":["luowei01"],"distractionFreeMode":false,"id":"3fd489b7b8647f92857071a5a6f6165a"});gitalk.render("gitalk-container");});};var gitalk = new Gitalk({"clientID":"Ov23liXJ47TD4diLy6Z5","clientSecret":"00f665c53d4f4f4ef1a0c8b86a918636233b54c5","repo":"blogs","owner":"luowei01","admin":["luowei01"],"distractionFreeMode":false,"id":"3fd489b7b8647f92857071a5a6f6165a"});gitalk.render("gitalk-container");</script></p>
<script type="text/javascript">var className='atoc';</script>

<footer class="page-footer"><b>&#x200B;&#x7248;&#x6743;&#x58F0;&#x660E;</b>:<span style="color:red;">&#x672C;&#x6587;&#x4E3A;&#x535A;&#x4E3B;&#x539F;&#x521B;&#x6587;&#x7AE0;&#xFF0C;&#x672A;&#x7ECF;&#x535A;&#x4E3B;&#x5141;&#x8BB8;&#x4E0D;&#x5F97;&#x8F6C;&#x8F7D;&#x3001;&#x6458;&#x7F16;&#x3001;&#x590D;&#x5236;&#x53CA;&#x5EFA;&#x7ACB;&#x955C;&#x50CF;&#xFF0C;&#x5982;&#x6709;&#x7248;&#x6743;&#x95EE;&#x9898;&#xFF0C;&#x8BF7;&#x8054;&#x7CFB;&#x535A;&#x4E3B;! </span><br><span class="copyright">Copyright &#xA9; luowei01 2024 all right reserved,powered by <a href="https://chateda.top/" target="_blank">luowei</a></span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2024-07-24 10:52:24
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="4.torch数据集类、加载、自带数据集、transform处理图像数据.html" class="navigation navigation-prev " aria-label="Previous page: 4.torch数据集类、加载、自带数据集、transform处理图像数据">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="实验一：手写数字识别.html" class="navigation navigation-next " aria-label="Next page: 实验一：手写数字识别">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"5.数据并行处理","level":"1.2.8","depth":2,"next":{"title":"实验一：手写数字识别","level":"1.2.9","depth":2,"path":"深度学习/实验一：手写数字识别.md","ref":"深度学习/实验一：手写数字识别.md","articles":[]},"previous":{"title":"4.torch数据集类、加载、自带数据集、transform处理图像数据","level":"1.2.7","depth":2,"path":"深度学习/4.torch数据集类、加载、自带数据集、transform处理图像数据.md","ref":"深度学习/4.torch数据集类、加载、自带数据集、transform处理图像数据.md","articles":[]},"dir":"ltr"},"config":{"plugins":["hide-element","chapter-fold","mathjax-pro","alerts","emphasize","prism","-highlight","localized-footer","mermaid-gb3","ga","accordion","theme-default","gtalk","atoc","splitter","back-to-top-button","chapter-fold","code","insert-logo","tbfed-pagefooter","change_girls","auto-scroll-table","custom-favicon"],"styles":{"website":"style.html"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy luowei01 2024","modify_label":"该文件修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"chapter-fold":{},"prism":{},"emphasize":{},"atoc":{"addClass":true,"className":"atoc"},"splitter":{},"change_girls":{"time":10,"urls":["https://images.pexels.com/photos/1103970/pexels-photo-1103970.jpeg","https://images.pexels.com/photos/311039/pexels-photo-311039.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"]},"accordion":{},"search":{},"auto-scroll-table":{},"localized-footer":{"filename":"FOOTER.md","hline":"true"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"gtalk":{"clientID":"Ov23liXJ47TD4diLy6Z5","clientSecret":"00f665c53d4f4f4ef1a0c8b86a918636233b54c5","repo":"blogs","owner":"luowei01","admin":["luowei01"],"distractionFreeMode":false},"mermaid-gb3":{},"favicon":"./favicon.ico","back-to-top-button":{},"alerts":{},"custom-favicon":{},"mathjax-pro":{"forceSVG":false,"version":"2.7.6"},"mathjax":{"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]],"processEscapes":true,"processEnvironments":true},"options":{"skipHtmlTags":["script","noscript","style","textarea","code"],"ignoreClass":"tex2jax_ignore","displayAlign":"center","displayIndent":"2em","showMathMenu":true,"menuSettings":{"zoom":"Zoom"}}},"ga":{"configuration":"auto","token":"UA-153583635-2"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"insert-logo":{"style":"background: none; max-height: 64px; min-height: 64px","url":"https://cdn.jsdelivr.net/gh/luowei01/images/images/blog_64.png"}},"theme":"default","author":"luowei","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"cover":"blog.png","title":"听风雨的博客","gitbook":"*","description":"记录生活和学习的点滴"},"file":{"path":"深度学习/5.数据并行处理.md","mtime":"2024-07-24T02:52:24.636Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-07-24T03:39:30.637Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mathjax-pro/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-alerts/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mermaid-gb3/book/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-atoc/atoc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-insert-logo/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-change_girls/girls.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-auto-scroll-table/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.min.js"></script>

    </body>
</html>

